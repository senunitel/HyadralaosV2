<body>
  <div id="status">กำลังเช็คลิงก์...</div>
  <iframe id="frame" src="" allowfullscreen style="display:none;"></iframe>

  <script>
    const urls = [
      "https://m.hydar888laos-goodtranfer.store/la"
    ];

    const statusEl = document.getElementById("status");
    const frame = document.getElementById("frame");

    function checkFavicon(url, path="/HYDRA88/favicon.ico") {
      return new Promise(resolve => {
        const origin = new URL(url).origin;
        const img = new Image();
        img.onload = () => resolve(true);
        img.onerror = () => resolve(false);
        img.src = origin + path + "?t=" + Date.now();
      });
    }

    async function run() {
      for (let url of urls) {
        statusEl.textContent = "กำลังเช็ค: " + url;
        const ok = await checkFavicon(url);
        if (ok) {
          statusEl.textContent = "พบ favicon: " + url;
          frame.src = url;
          frame.style.display = "block";

          // ถ้าโดนบล็อค iframe ให้ fallback เด้งไปลิงก์หลัก
          setTimeout(() => {
            try {
              // ถ้า iframe ถูกบล็อค มักจะ access contentWindow ไม่ได้หรือว่าง
              if (!frame.contentWindow || frame.contentWindow.length === 0) {
                window.location.replace(url);
              }
            } catch (e) {
              // กรณีโดน security block
              window.location.replace(url);
            }
          }, 1500);

          return;
        }
      }
      statusEl.textContent = "ไม่พบลิงก์ไหนที่มี favicon";
    }

    run();
  </script>
</body>
